function addMediaInfo(e){var o="<li>";o+='<a href="'+e.link+'" target="_blank">',o+='<img src="'+e.images.thumbnail.url+'">',o+='<div class="media__des"><div class="media__inner"><div class="media__meta"><p class="media__caption"><small>',o+=e.caption.text,o+="</small></p></div></div></div>",o+="</a>",o+="</li>",$("#media-list").append(o)}function adduserInfo(e){var o=(e.username,"<li>");o+='<a href="https://www.instagram.com/'+e.username+'/" target="_blank">',o+="<p>"+e.full_name+"</p>",o+="<img src='"+e.profile_picture+"' width='70' height='70' >",o+="</a>",o+="</li>",$("#followed-list").append(o)}function runFunc(){navigator.geolocation?getLocation():alert("On your divice, you can't get your location.")}function getLocation(){var e={enableHighAccuracy:!1,timeout:8e3,maximumAge:5e3};navigator.geolocation.getCurrentPosition(successFunc,errorFunc,e)}function successFunc(e){var o=document.getElementById("map-canvas"),a=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),n={zoom:15,center:a};map=new google.maps.Map(o,n),$.ajax({url:"https://api.instagram.com/v1/media/search?lat="+e.coords.latitude+"&lng="+e.coords.longitude+"&access_token="+exis_accesstoken,method:"get",dataType:"jsonp",success:function(o){console.log(o),iconPin(o.data,e.coords)}})}function iconPin(e,o){function a(){t();for(var e=0;e<s.length;e++)n(s[e],80*e,e),c.push(new google.maps.InfoWindow({content:l[e]}))}function n(o,a,n){window.setTimeout(function(){var a={url:e[n].user.profile_picture,scaledSize:new google.maps.Size(40,40)},t=new google.maps.Marker({position:o,map:map,icon:a,title:e[n].user.full_name,animation:google.maps.Animation.DROP});t.addListener("click",function(){window.open(e[n].link,"_blank")}),t.addListener("mouseover",function(){c[n].open(map,t)}),t.addListener("mouseout",function(){c[n].close()}),i.push(t)},a)}function t(){for(var e=0;e<i.length;e++)i[e].setMap(null);i=[]}for(var s=[],i=[],l=[],c=[],r=0;r<e.length;r++){s.push({lat:e[r].location.latitude,lng:e[r].location.longitude});var d='<div class="blow"><div class="blow-img"><img src="'+e[r].images.thumbnail.url+'"></div>';null!==e[r].caption&&(d+="<p>"+e[r].caption.text+"</p>"),d+="<span>by: "+e[r].user.full_name+"</span></div>",l.push(d)}a()}function errorFunc(e){var o={0:"An unknown error occurred...",1:"Acquisition of location information was not permitted",2:"Position information could not be acquired due to radio wave conditions etc...",3:"time out"};console.log(o[e.code])}var url_self="https://api.instagram.com/v1/users/self/",url_users="https://api.instagram.com/v1/users/",url_self_media="https://api.instagram.com/v1/users/self/media/recent/",exis_accesstoken,map;$(function(){if(exis_accesstoken=localStorage.getItem("access_token"),!exis_accesstoken||"undefined"==exis_accesstoken){for(var e=new Object,o=location.hash.substring(1).split("#"),a=0;o[a];a++){var n=o[a].split("=");e[n[0]]=n[1],console.log(o[0])}localStorage.setItem("access_token",e.access_token)}$.ajax({url:url_self+"?access_token="+exis_accesstoken,method:"get",dataType:"jsonp",success:function(e){void 0!==e?($("#username").append(e.data.username),$("#name").append(e.data.full_name),$("#bio").append(e.data.bio),$(".profile-img").find("img").attr("src",e.data.profile_picture),$("#followed").append(e.data.counts.followed_by),$("#follows").append(e.data.counts.follows),$("#media").append(e.data.counts.media)):$(".profile-box").remove()}}),$.ajax({url:url_self+"followed-by?access_token="+exis_accesstoken,method:"get",dataType:"jsonp",success:function(e){if(e.data.length>=1){$("<h2>FOLLOWED USERS</h2>").prependTo("#followed-box");for(var o=0;e.data.length>o;o++)adduserInfo(e.data[o])}}}),$.ajax({url:url_self_media+"?access_token="+exis_accesstoken,method:"get",dataType:"jsonp",success:function(e){for(var o=0;e.data.length>o;o++)addMediaInfo(e.data[o])}}),$("#sinofool-btn").on("click",function(){$.ajax({url:url_users+"1474272023/?access_token="+exis_accesstoken,method:"get",dataType:"jsonp",success:function(e){void 0!==e&&($(".profile-box").clone().addClass("sinofool").appendTo("#test-detail"),$("#username",".sinofool").html(e.data.username),$("#name",".sinofool").html(e.data.full_name),$("#bio",".sinofool").html(e.data.bio),$(".profile-img",".sinofool").find("img").attr("src",e.data.profile_picture),$("#followed",".sinofool").html(e.data.counts.followed_by),$("#follows",".sinofool").html(e.data.counts.follows),$("#media",".sinofool").html(e.data.counts.media))}})})});